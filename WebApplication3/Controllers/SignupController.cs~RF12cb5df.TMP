using System;
using System.Collections.Generic;
using System.Data.Entity.Validation;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using WebApplication3.context;

namespace WebApplication3.Controllers
{
    public class SignupController : Controller
    {
        // GET: Signup
        Sample_1Entities8 dbObj = new Sample_1Entities8();
        public ActionResult Signup(User obj)
        {
            return View(obj);
        }
        [HttpPost]
        public ActionResult AddUser(User model)
        {

            if (ModelState.IsValid)
            {
                User obj = new User();
                obj.ID = model.ID;
                obj.RoleID = 1;
                obj.FirstName = model.FirstName;
                obj.LastName = model.LastName;
                obj.EmailID = model.EmailID;
                obj.Password = model.Password;
                obj.IsEmailVerified = true;
                obj.CreatedDate = model.CreatedDate;
                obj.CreatedBy = 1;
                obj.ModifiedDate = model.ModifiedDate;
                obj.ModifiedBy = 1;
                obj.IsActive =true;


               if (model.ID == 0)
                { 
                    dbObj.Users.Add(obj);
                    try
                    {
                        dbObj.SaveChanges();
                    }
                    catch(DbEntityValidationException e)
                    {
                        Console.WriteLine(e);
                    }

                }
                else
                {
                    dbObj.Entry(obj).State = System.Data.Entity.EntityState.Modified;
                    dbObj.SaveChanges();
                }
            }
            ModelState.Clear();

            return View("Signup");
        }
    }
}